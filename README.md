# -LSTM
Athena Technology社の技術課題
本リポジトリは、株価終値系列に対して LSTM + 分位回帰 を用い、
点予測（中央値 q50） と 不確実性の区間推定（q10–q90） を同時に行う実装です。
開発環境については、Google Colaboratoryで実施した。

時系列データについて、過去60日のデータから次のデータを予測します。

評価指標は、以下である。
点予測（q50）: RMSE, MAE, Directional Accuracy（上げ下げ）
区間: PI Coverage（q10–q90 に入る割合）, PI Avg Width（平均幅）

さらに、Conformalized Quantile Regression (CQR) による区間の較正、
および 方向（上昇/下落）分類器 を組み合わせた検証スクリプトを含みます。
1. プログラムの概要
1.1 目的
翌営業日の終値の分位を予測し、予測区間として提示
予測区間の被覆率（Coverage）と幅（AvgWidth）管理
1.2 手法の要点
LSTM 分位回帰：q10, q50, q90 を同時に推定
旧モデル：素の分位出力
新モデル：単調パラメトリック（q10≤q50≤q90を構造的に担保）
幅ペナルティ（λ）で区間を意図的に狭めるオプション
CQR（Conformalized Quantile Regression）：検証セットに基づき、区間の過小・過大を後処理で補正
方向分類器：ロジスティック回帰で P(up) を推定し、q50の符号よりも堅牢な方向判定を提供
特徴量エンジニアリング：
価格・出来高（log1p）
リターン（ret, logret）
テクニカル：SMA/EMA、MACD、ATR、ローリング分散（rv）
カレンダー：曜日ダミー、月を sin/cos の循環表現
ギャップ・休場フラグ等の追加特徴（方向分類器で使用）
